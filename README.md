# Auto generate api document with gin 

This project contain code generate (to implement pseudo annotation), and should run as an extra part of your project. 

# Feature
- Low invasive of code
- Auto analyze URL path and relate it to handler function. (Now, you don't need to write the url path manually)
- Relate the request/response struct to handler function, and auto analyze the fields of the struct.


Usage:

1. install code generate tool: `ann`
```
go install github.com/go-chocolate/chocdoc/cmd/ann@latest
```
2. run `ann` in project root directory
3. use chocdoc to generate documents
```go
package main

import (
    "github.com/go-chocolate/chocdoc/chocdoc"
    "github.com/gin-gonic/gin"
    "[YOUR PROJECT MODULE PATH]/annotation"
    "[YOUR PROJECT MODULE PATH]/router"
)

func main() {
    var engine = gin.New()

    //use this way to get all of your routers
    router.Route(engine) 
    
    // annotation.Nodes() is the code generated by ann
    documents := chocdoc.Decode(engine,annotation.Nodes())
    documentGroup := documents.Group()
    // the result contains all document info, use it as you wanted.
}
```

4. define document information in handler
```go

// Example
// @summary example
// @description example handler
// @request [binding.ExampleRequest]
// @response [binding.ExampleResponse]
func ExampleDoc(ctx *gin.Context) {
    
}

func AnonymousHandler() func(*gin.Context) {
    return func(ctx *gin.Context){
    }
}


func Route(engine *gin.Engine) {
    engine.GET("/example/hello", ExampleDoc)
    
    //or if your handler is an anonymous function, chocdoc cannot relate the routed path with anonymous function. (cannot get the unique function signature)
    //use an empty doc function as the last middleware to solve it. 
    engine.GET("/example/hello", AnonymousHandler(), ExampleDoc)
}
```
All the comment that on the top of exported function/struct will be analyzed by `ann`, and auto generate code to relate the function/struct and annotation.

The object in square brackets will be treated as linked struct, and will be created in generated code. Chocdoc can analyze it by use reflect.

The object in angle brackets will be treated as linked function, and the full import path will be saved in generated code. It's not used now, or maybe you'd like to do something with it.




# TODO
- Render UI
- export to swagger